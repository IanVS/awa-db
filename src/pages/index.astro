---
import Pagination from '@/molecules/Pagination.astro';
import Grid from '@/organisms/Grid.astro';
import Layout from '@/layouts/Layout.astro';

import marketplace from '@/db/marketplace.json';
import { NUM_ITEMS_BY_PAGE, removeUknownItems } from '@/utils/utils';

import type { TypeMarketItem } from '@/types';
import type { Page } from 'astro';

export type Props = {
  page: Page<TypeMarketItem>;
};

const marketplaceWithoutUnknownItems = (marketplace as TypeMarketItem[]).filter(
  removeUknownItems
);

const page = {
  data: marketplaceWithoutUnknownItems.slice(0, NUM_ITEMS_BY_PAGE),
  start: 0,
  end: 8,
  total: marketplaceWithoutUnknownItems.length,
  currentPage: 1,
  size: NUM_ITEMS_BY_PAGE,
  lastPage: Math.ceil(
    marketplaceWithoutUnknownItems.length / NUM_ITEMS_BY_PAGE
  ),
  url: {
    current: '/',
    next: '/2',
    prev: undefined,
  },
};
---

<Layout
  title={`Marketplace, Page ${page.currentPage} of the item list.`}
  description={`List of all items that was released in Alienware Arena Marketplace, page ${page.currentPage} of ${page.lastPage}`}
>
  <Grid items={page.data} class="mb-4" />
  <Pagination
    currentPage={page.currentPage}
    firstPage={1}
    lastPage={page.lastPage}
    url={{ prev: page.url.prev, next: page.url.next }}
  />
</Layout>
